---
title: http 协议
categories:
tags:
---

## http 的隐患

1. 与服务器进行通信使用的是明文，内容可能会被窃听（HTTP 协议本身并不具备加密功能，所以无法对请求和响应的内容进行加密）
2. 使用 HTTP 协议的服务器与客户端都不会验证通信方的身份，可能遭遇伪装。（所谓不验证通信方身份的意思是，比如说服务端，在服务端接收到请求的时候，只要请求的信息正确，服务器并不会去验证，这个请求是否由其对应的客户端发出。并且，服务器会对请求立即做出一次响应，返回相应的数据）
3. 使用 HTTP 协议的服务器与客户端都无法验证报文的完整性，所以在通信过程中，报文有可能会被篡改等等。

## 特点

1. HTTP/1.0 一次只允许在一个 TCP 连接上发起一个请求；HTTP/1.1 流水线技术也只能部分处理请求并发，并仍然存在队列头阻塞问题，因此客户端在需要发起多次请求时，典型情况下，通常采用建立多连接来减少延迟。
2. 单向请求，请求只能由客户端发起。
3. 请求报文与响应报文首部信息冗余量大。
4. 数据未压缩，数据传输量大。

## htpp1.0

1. http 是无状态链接，即他只管链接，不管你们之前是否链接过，故通常通过设置 cookie 来记录用户的登录状态，服务器生成 session 来用记录用户登录的上下文，并生成 sessionId 来唯一标识这条记录，然后将其放到响应头李，后续浏览器发起请求再次带上该请求头，即可分辨其用户状态；
2. http 基于 TCP 链接，从建立链接到断开要经过三次握手以及四次挥手，并且一个 http 链接只新建一个 tcp 链接，请求以及响应以文本形式传输，每次传输完数据就断开链接；
3. 同时如果发生了丢包，需要重新建立 tcp 链接,这就导致了 http1.0 下传输效率其实并不高，每个资源的请求以及响应都要在队列中进行排队，等待传输
4. http1.0 也是支持长链接的，但默认是关闭的 `keep-alive:false`

## http1.1

1. http1.1 默认使用长链接，减少了 tcp 建立链接耗费的时间`keep-alive:true`

## https

为了解决 http 协议的保密性（防泄密）、完整性（防篡改）、真实性（防假冒），发展出了 https 协议，HTTPS 是由 HTTP 协议+SSL 协议（TLS）构成。SSL 协议通过对信息进行加密，为网络通信提供安全保障。它运用了非对称密钥机制，这种机制是将公钥自由对外分发，而私钥只有信息接收者才有。简单的说，其实 HTTPS = HTTP + 加密 + 认证 + 完整性保护

HTTP/2 的优势

1. 相比 HTTP/1.x，HTTP/2 在底层传输做了很大的改动和优化
2. HTTP/2 采用二进制格式传输数据，而非 HTTP/1.x 的文本格式。二进制格式在协议的解析和优化扩展上带来更多的优势和可能。
3. HTTP/2 对消息头采用 HPACK 进行压缩传输，能够节省消息头占用的网络的流量。而 HTTP/1.x 每次请求，都会携带大量冗余头信息，浪费了很多带宽资源。头压缩能够很好的解决该问题。
4. 多路复用，直白的说就是所有的请求都是通过一个 TCP 连接并发完成。HTTP/1.x 虽然能利用一个连接完成多次请求，但是多个请求之间是有先后顺序的，后面发送的请求必须等待上一个请求返回才能发送响应。这会很容易导致后面的请求被阻塞，而 HTTP/2 做到了真正的并发请求。同时， 流还支持优先级和流量控制。
5. Server Push：服务端能够更快的把资源推送给客户端。例如服务端可以主动把 JS 和 CSS 文件推送给客户端，而不需要客户端解析 HTML 再发送这些请求。当客户端需要的时候，它已经在客户端了。

**配置网站的 https:**

1. 购买证书
2. 修改 nginx 配置

**_小网站的 https_**

傻瓜式设置: **certbot**

## 常见的状态码

- 200 OK 客户端请求成功
- 301 Moved Permanently 请求永久重定向
- 302 Moved Temporarily 请求临时重定向
- 304 Not Modified 文件未修改，可以直接使用缓存的文件。
- 400 Bad Request 由于客户端请求有语法错误，不能被服务器所理解。
- 401 Unauthorized 请求未经授权。这个状态代码必须和 WWW-Authenticate 报头域一起使用
- 403 Forbidden 服务器收到请求，但是拒绝提供服务。服务器通常会在响应正文中给出不提供服务的原因
- 404 Not Found 请求的资源不存在，例如，输入了错误的 URL
- 500 Internal Server Error 服务器发生不可预期的错误，导致无法完成客户端的请求。
- 503 Service Unavailable 服务器当前不能够处理客户端的请求，在一段时间之后，服务器可能会恢复正常

相关阅读：
[http://www.ruanyifeng.com/blog/2016/08/http.html](http://www.ruanyifeng.com/blog/2016/08/http.html)
[http-tcp](https://juejin.cn/post/6844903609138692110#heading-1)
