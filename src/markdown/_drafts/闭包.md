---
title: 闭包
categories:
  - 前端
tags:
  - javascript
---

```javascript
function f1() {
  var n = 999;

  function f2() {
    alert(n);
  }

  return f2;
}

var result = f1();

result(); // 999
```

## 闭包的概念

上一节代码中的 f2 函数，就是闭包。

闭包就是能够读取其他函数内部变量的函数。

由于在 Javascript 语言中，只有函数内部的子函数才能读取局部变量，因此可以把闭包简单理解成"定义在一个函数内部的函数"。

闭包的最大用处有两个，一个是可以读取函数内部的变量，另一个就是让这些变量的值始终保持在内存中。

## 闭包的变量

1. 对函数进行预解析
第一，是判断当前函数是不是存在一些语法上的错误，

第二：当 V8 解析一个函数的时候，还需要判断该函数的内部函数是否引用了当前函数内部声明的变量，如果引用了，那么需要将该变量存放到堆中，即便当前函数执行结束之后，也不会释放该变量。

## 闭包的应用场景
